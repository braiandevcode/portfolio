import{mediaQuerysMin}from"./helper/mediaQuerys.min.js";import updateClassName from"./helper/updateClassName.min.js";import{eventClick}from"./js/events.min.js";import{validateMedia568,validateMedia767}from"./js/validateMedia.min.js";import{showModalsMessageAlert}from"./helper/showModals.min.js";import queryAjax from"./js/ajax.min.js";const $inputs=document.querySelectorAll(".input-data .input"),$form=document.getElementById("form-contact"),LOADER=document.querySelector(".container-loadding"),emailRegExp=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,nameRegExp=/^[a-zA-Z\s]{3,25}$/;let url="https://server-portfolio-arrb.onrender.com";const initServiceEmailJs=async()=>{const e=await queryAjax(`${url}/api/config`,null);if(e){const{USER_ID:a}=e;return await emailjs.init(a),e}return showModalsMessageAlert(10),null},postEmail=async(e,a)=>{const{TEMPLATE_ID:t,SERVICE_ID:s}=a;try{updateClassName("add",LOADER,null,"loadding-show"),await emailjs.sendForm(s,t,e),updateClassName("remove",LOADER,null,"loadding-show"),showModalsMessageAlert(7)}catch(e){updateClassName("remove",LOADER,null,"loadding-show"),showModalsMessageAlert(10)}},validateNameInput=e=>{const a=e.value.trim();return"email"===e.name?!!emailRegExp.test(a)||(showModalsMessageAlert(8),!1):"nameComplete"!==e.name||(!!nameRegExp.test(a)||(showModalsMessageAlert(11),!1))},validateAllFields=()=>{let e=!0;return $inputs.forEach((a=>{""===a.value.trim()?(e=!1,showModalsMessageAlert(9)):validateNameInput(a)||(e=!1)})),e},submitForm=()=>{$form.addEventListener("submit",(async e=>{e.preventDefault();if(validateAllFields())try{const e=await initServiceEmailJs();e&&(await postEmail($form,e),$form.reset())}catch(e){throw e}}))};mediaQuerysMin(520,validateMedia568),mediaQuerysMin(767,validateMedia767),eventClick(),location.pathname.includes("/dist/pages/form.html")&&(updateClassName("remove",LOADER,null,"loadding-show"),submitForm());